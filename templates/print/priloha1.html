<!-- V templates/print/priloha1.html - aktualizace stylu -->

<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Příloha 1 - Hodnoty měření k dokladu {{ faktura.cislo_faktury if faktura else '' }}</title>
    <style>
        @page {
            margin: 15mm 10mm;
            @bottom-left {
                content: "FAKTURA: {{ faktura.cislo_faktury if faktura else '' }}";
                font-family: Arial, sans-serif;
                font-size: 9px;
            }
            @bottom-right {
                content: "strana " counter(page) "/" counter(pages);
                font-family: Arial, sans-serif;
                font-size: 9px;
            }
        }
        body { font-family: Arial, sans-serif; font-size: 11px; line-height: 1.2; margin: 0; }
        
        .page-header { 
            text-align: center; 
            margin-bottom: 20px; 
            padding-bottom: 10px;
        }
        .header-line1 { font-weight: bold; margin-bottom: 5px; }
        .document-title { font-size: 14px; font-weight: bold; margin-bottom: 10px; }
        
        /* ✅ NOVÝ STYL PRO ODBĚRNÁ MÍSTA */
        .odberne-misto {
            margin-bottom: 20px;
            page-break-inside: avoid;
        }

        /* ✅ PAGE BREAK - každé OM na nové stránce */
        .om-page-break {
            page-break-after: always;
        }
        .om-header { 
            font-weight: bold; 
            margin-bottom: 5px; 
            font-size: 11px;
            /* ✅ Název na jednom řádku */
            white-space: nowrap;
        }
        
        /* ✅ ČISTÁ TABULKA BEZ OHRANIČENÍ */
        .mereni-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-bottom: 15px;
            /* ✅ Bez ohraničení */
            border: none;
        }
        .mereni-table th { 
            /* ✅ Bez pozadí, pouze spodní šedá čára */
            background-color: transparent; 
            border: none;
            border-bottom: 1px solid #ccc;
            padding: 3px 6px; 
            text-align: left; 
            font-weight: bold;
            /* ✅ Menší písmo */
            font-size: 9px;
        }
        .mereni-table td { 
            /* ✅ Bez ohraničení */
            border: none;
            padding: 2px 6px; 
            /* ✅ Menší písmo */
            font-size: 8px;
        }
        
        /* ✅ ZAROVNÁNÍ PODLE VZORU */
        .mereni-table .description { text-align: left; }
        .mereni-table .number { text-align: right; }
        .mereni-table .date { text-align: left; }
        .mereni-table .unit { text-align: left; }
        
        /* ✅ Odstranění barevného podbarveníí */
        .vt-row { background-color: transparent; }
        .nt-row { background-color: transparent; }
        
        .back-link { 
            margin-top: 30px; 
            text-align: center; 
        }
    </style>
</head>
<body>
    <!-- HLAVIČKA -->
    <div class="page-header">
        <div class="document-title">Příloha 1 - Hodnoty měření k dokladu</div>
    </div>

    <!-- ✅ ODBĚRNÁ MÍSTA - nový design podle vzoru -->
    {% for odecet in odecty %}
    {% set om = odecet.odberne_misto %}
    <div class="odberne-misto {% if faktura and faktura.om_na_stranku %}om-page-break{% endif %}">
        <!-- ✅ Název na jednom řádku -->
        <div class="om-header">
            Odběrné místo: {{ om.cislo_om if om else odecet.oznaceni }} {{ om.nazev_om if om else '' }}
        </div>
        
        <!-- ✅ Čistá tabulka bez ohraničení -->
        <table class="mereni-table">
            <thead>
                <tr>
                    <th class="description">Měření</th>
                    <th class="date">Od</th>
                    <th class="date">Do</th>
                    <th class="number">Počátek</th>
                    <th class="number">Konec</th>
                    <th class="number">Spotřeba</th>
                    <th class="unit">MJ</th>
                    <th class="description">Poznámka</th>
                </tr>
            </thead>
            <tbody>
                <!-- VT řádek - zobrazit pouze pokud je spotřeba nenulová -->
                {% if odecet.spotreba_vt and odecet.spotreba_vt != 0 %}
                <tr>
                    <td class="description">Spotřeba VT</td>
                    <td class="date">{{ odecet.zacatek_periody_mereni.strftime('%d.%m.%Y') if odecet.zacatek_periody_mereni else '' }}</td>
                    <td class="date">{{ odecet.konec_periody_mereni.strftime('%d.%m.%Y') if odecet.konec_periody_mereni else '' }}</td>
                    <td class="number">{{ odecet.pocatecni_hodnota_vt|number_format if odecet.pocatecni_hodnota_vt else '' }}</td>
                    <td class="number">{{ odecet.hodnota_odectu_vt|number_format if odecet.hodnota_odectu_vt else '' }}</td>
                    <td class="number">{{ odecet.spotreba_vt|number_format if odecet.spotreba_vt else '' }}</td>
                    <td class="unit">kWh</td>
                    <td class="description">{{ '' if not odecet.priznak or odecet.priznak == 'N' else odecet.priznak }}</td>
                </tr>
                {% endif %}

                <!-- NT řádek - zobrazit pouze pokud je spotřeba nenulová -->
                {% if odecet.spotreba_nt and odecet.spotreba_nt != 0 %}
                <tr>
                    <td class="description">Spotřeba NT</td>
                    <td class="date">{{ odecet.zacatek_periody_mereni.strftime('%d.%m.%Y') if odecet.zacatek_periody_mereni else '' }}</td>
                    <td class="date">{{ odecet.konec_periody_mereni.strftime('%d.%m.%Y') if odecet.konec_periody_mereni else '' }}</td>
                    <td class="number">{{ odecet.pocatecni_hodnota_nt|number_format if odecet.pocatecni_hodnota_nt else '' }}</td>
                    <td class="number">{{ odecet.hodnota_odectu_nt|number_format if odecet.hodnota_odectu_nt else '' }}</td>
                    <td class="number">{{ odecet.spotreba_nt|number_format if odecet.spotreba_nt else '' }}</td>
                    <td class="unit">kWh</td>
                    <td class="description">{{ '' if not odecet.priznak or odecet.priznak == 'N' else odecet.priznak }}</td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
    {% endfor %}

</body>
</html>